# Weedformer
Rethinking Spot Spraying Perception Frameworks: A Real-Time Segmentation Approach Integrating Crop Contours and a Weed Index
Precise perception of crops and weeds is crucial for spot-spraying weeding (SSW). However, existing methods rely heavily on manually annotated data and are susceptible to lighting variations in agricultural environments, thereby limiting the robustness, stability, and real-time performance of SSW perception systems. To address these challenges, this study proposed Weedformer, a real-time perception frameworks that integrated crop contour extraction (CCEformer) with the weed index to enable precise segmentation and spraying of early-stage corn and weeds. First, CCEformer combined a lightweight pixel decoder (LPD) with a dual-core transformer decoder (DTD). This design preserved model compactness while substantially improving real-time contour extraction, reducing the model size to 31.5MB while sustaining 57.2FPS. In addition, we designed a Crop Contour Loss (CCL) to improve contour extraction by dynamically predicting key points. Overall, the model achieved an mAP of 98.49% and a recall of 96.32% for crop contour segmentation, outperforming existing models. Second, the proposed Weed Index converted the non-crop regions extracted by CCEformer to the YCrCb color space and incorporated VARI to extract weeds, thereby mitigating the effects of illumination variation on weed segmentation. Even without manual annotations, this method achieved a Dice score of 0.87 and an accuracy of 90.97% for weed segmentation. Experiments demonstrated that Weedformer achieved overall weed accuracy and HIT rates of up to 98.26% and 93.51%, respectively, in practical SSW systems, with pesticide savings reaching 42.44%. The proposed method provided a reliable technical foundation for achieving precise, targeted spot spraying with intelligent application equipment. The code for the proposed methods was open-sourced at: https://github.com/anqilin8/Weedformer
